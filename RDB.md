# RDB

### 관계 데이터 모델

- 동일한 구조(릴레이션) 관점에서 모든 데이터를 논리적으로 구성
- 질의어를 통한 데이터 접근
- 응용 프로그램들은 데이터베이스 레코드들의 순서와 무관하게 작성
    - 사용자는 데이터만 명시하면 된다.

### 기본 용어

| 릴레이션 | 2차원의 테이블 |
| --- | --- |
| 레코드 | 릴레이션의 각 행 |
| 투플 | 투플  = 레코드 |
| 애트리뷰트 | 릴레이션의 각 열(명시) |

![Alt text](https://user-images.githubusercontent.com/84346055/252251432-ae589b59-924a-4df7-9530-e100222889fd.png)

**도메인**

- 애트리뷰트에 나타날 수 있는 값들의 집합 (값들은 기본적으로 **원자값**)
    - 자료형과 유사한 개념
    - 복합 애트리뷰트 , 다치 애트리뷰트는 허용되지 않는다.

**차수**

- 릴레이션의 애트리뷰트의 개수
    - 변화가 적다. 최소 개수는 1

**카디날리티**

- 한 릴레이션의 투플의 개수 (데이터의 개수)
    - 변화가 많다. 최소 개수는 0

### 릴레이션 스키마

- 릴레이션(테이블)의 이름과 애트리뷰트들의 집합
    - 테이블의 규격 , 틀 즉 **내포**
- 테이블을 설계 → 릴레이션 스키마를 설계하는 것
- 릴레이션 내에서 애트리뷰트들의 배치 순서는 의미가 없다 !

### 릴레이션 인스턴스

- 특정 시점에 릴레이션에 들어 있는 투플들의 집합
    - 시간의 흐름에 따라 계속 변화 , **외연**

![Alt text](https://user-images.githubusercontent.com/84346055/252251406-e58e4f5d-210a-4fe4-a213-029a839ef1f3.png)

- **릴레이션의 투플들은 중복은 허용되지 않는다.**

  **키**를 통해 투플들을 구분


### 키

- 투플을 고유 식별 가능한 하나 이상의 애트리뷰트들의 집합
    - 수퍼 키 , 후보 키, 기본 키, 대체 키, 외래 키

**수퍼 키(Super Key)**

- 릴레이션내의 **투플을 고유하게 식별**하는 애트리뷰트 또는 애트리뷰트들의 집합
    - 수퍼 키는 투플을 고유 식별하는데 필요하지 않은 애트리뷰트 포함 가능

**후보 키**

- 투플을 고유하게 식별 **최소한의 애트리뷰트**들의 모임
    - 모든 릴레이션에는 최소한 한개 이상의 후보키 존재
    - 후보키가 두 개 이상 애트리뷰트 포함 → **복합 키**

![Alt text](https://user-images.githubusercontent.com/84346055/252251418-8b32834d-efdd-4a0a-a446-e46063e0f023.png)

- **수강 릴레이션의 후보 키**

  학번 , 과목 번호 , 학점 각 애트리뷰트들로는 고유 식별 불가능

  (학번, 과목 번호) 가 묶인 복합키가 후보키 !


**기본 키**

- 후보 키 중 하나를 선정
    - 투플들을 고유하게 식별 가능하며 최소한의 애트리뷰트들의 모임
- 인위적인 애트리뷰트 키가 릴레이션에 추가 가능 → 기본 키로 사용
    - **레코드 번호 ( 대리 키라고 부름 )**

**대체 키**

- 후보 키중 기본 키가 아닌 것

![Alt text](https://user-images.githubusercontent.com/84346055/252251423-55768994-240e-4743-b825-37301d1e3157.png)

**외래 키**

- **다른 릴레이션의 기본 키를 참조**하는 애트리뷰트
    - RDB에서는 릴레이션 간의 관계를 나타내기 위해 사용

![Alt text](https://user-images.githubusercontent.com/84346055/252251426-d6696d09-7fd4-4879-8f2d-516d37cd243b.png)

- 자체 테이블 내에서 기본 키를 외래 키로 참조 가능
    - ex ) 사원 번호를 사원 테이블 내에서 사수 번호(외래 키) 사용
- 외래 키가 기본 키의 구성요소가 되기도 함

## 무결성 제약조건

### 데이터 무결성

- 데이터의 **정확성, 유효성**
    - 일관된 데이터 베이스 상태를 정의하는 규칙들을 정의할 필요가 있다.

### 도메인 제약조건

- 각 애트리뷰트 값이 반드시 **원자값**이어야 한다.
    - 애트리뷰트 Default 값 , 값의 범위 지정
    - **데이터 형식(도메인) , CHECK 제약 조건**

### 키 제약조건

- 키 애트리뷰트에 중복된 값은 존재해서는 안된다.

1. **기본키와 엔티티 무결성 제약조건**
    - 기본키를 구성하는 애트리뷰트들은 **널값을 허용하지 않는다.**
    - 대체 키에는 적용되지 않는다.

1. **외래키와 참조 무결성 제약조건**
    - 두 릴레이션 사이 일관성 유지를 위해 사용
    - **만족 조건**
        - 외래 키의 값은 어떤 투플의 기본 키값과 동일
        - 외캐 키가 기본 키를 구성하고 있지 않는다면 널값 허용

### 삽입,삭제,수정 연산과 무결성

![Alt text](https://user-images.githubusercontent.com/84346055/252251428-2d08fa32-1327-462f-aa20-6194bf3a9a30.png)

**삽입**

- 참조되는 릴레이션에 투플 **삽입** → **참조 무결성 제약조건 위배 X**
- 참조하는 릴레이션에 투플 **삽입** → **참조 무결성 제약조건 위배 가능**
    - 다른 릴레이션에 존재하지 않는 기본키 참조 시 위배

**삭제**

- 참조하는 릴레이션 투플 **삭제 → 모든 제약 조건 위배 X**
- 참조되는 릴레이션 투플 **삭제 → 참조 무결성 제약조건 위배 가능**

### 참조 무결성 제약조건 유지 방법

- **제한(restricted)**
    - 위반하는 연산을 단순히 거절
- **연쇄(cascade)**
    - 참조되는 릴레이션 투플 삭제 시 참조하는 릴레이션의 연관된 투플들도 함께 삭제
- **널값(nullify)**
    - 참조되는 릴레이션 투플 삭제 → 참조하는 릴레이션 투플 외래키 널값 삽입
        - 외래키는 널값을 허용하기 때문에 가능

  **디폴트값(default)**

    - 위의 작업 중 널값 대신 디폴트값 삽입

**수정**

- 기본 키나 외래 키를 수정 → 하나의 투플 삭제 + 투플 삽입과 유사함
    - 참조되는 릴레이션 , 참조하는 릴레이션 → 참조 무결성 제약조건 위배 가능
